API Endpoints (Документация API)

1. Auth Module (Модуль Авторизации)
   - POST /auth/register
     - Описание: Регистрация нового пользователя.
     - Тело запроса (Body): RegisterDto
       - firstName: string (Имя)
       - surname: string (Фамилия)
       - email: string (Email, уникальный)
       - password: string (Пароль, мин. 6 символов)
     - Возвращает:
       - 201 Created: { user: User } (Созданный пользователь)
       - 401 Unauthorized: { message: "Email already registered" } (Email уже занят)

   - POST /auth/login
     - Описание: Вход в систему (логин).
     - Тело запроса (Body):
       - email: string
       - password: string
     - Возвращает:
       - 201 Created: { user: User, token: string } (Пользователь и JWT токен)
       - 401 Unauthorized: { message: "Invalid credentials" } (Неверные данные)

   - GET /auth/profile
     - Описание: Получение профиля текущего пользователя по токену.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: User (Данные пользователя из токена)
       - 401 Unauthorized: { message: "Invalid token" } (Неверный токен)

2. Courses Module (Модуль Курсов)
   - GET /courses
     - Описание: Получение списка всех курсов.
     - Возвращает:
       - 200 OK: { data: Course[] } (Список курсов с категориями и количеством модулей)

   - GET /courses/categories
     - Описание: Получение списка всех категорий курсов.
     - Возвращает:
       - 200 OK: { data: Category[] } (Список категорий)
       - Поля категории: id, name, description, created_at

   - GET /courses/enrolled/with-last-lesson
     - Описание: Получение списка курсов, на которые записан пользователь, с информацией о последнем открытом уроке.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { data: Course[] }
       - Включает: enrollment (прогресс), lastLesson (последний урок: id, title, module)

   - GET /courses/enrolled
     - Описание: Получение списка курсов, на которые записан пользователь (без детальной инфо о последнем уроке).
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { data: Course[] } (Список курсов с прогрессом)

   - GET /courses/:id
     - Описание: Получение детальной информации о конкретном курсе.
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { data: Course } (Курс с модулями, уроками, категориями и отзывами)
         - isEnrolled: boolean (подписан ли пользователь на курс)
         - tests: Test[] (Тесты курса с информацией о прохождении)
           - Каждый тест содержит:
             - completed: boolean (пройден ли тест)
             - passed: boolean (сдан ли тест успешно)
             - score: number (набранные баллы)
         - modules: Module[] (Модули курса)
           - Каждый модуль содержит:
             - isLocked: boolean (заблокирован ли модуль - true если пользователь не подписан)
             - completed: boolean (все ли уроки модуля пройдены)
             - progress: number (процент завершения модуля 0-100)
             - tests: Test[] (Тесты модуля с информацией о прохождении)
             - lessons: Lesson[] (Уроки модуля)
               - Каждый урок содержит:
                 - completed: boolean (пройден ли урок пользователем)
                 - tests: Test[] (Тесты урока с информацией о прохождении)
       - 404 Not Found: { message: "Course not found" } (Курс не найден)
       - 401 Unauthorized: { message: "Invalid token" } (Неверный токен)


   - POST /courses/:id/register
     - Описание: Запись пользователя на курс.
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 201 Created: { message: "Successfully registered", enrollment: Enrollment } (Успешная запись)
       - 201 Created: { message: "User already enrolled", enrollment: Enrollment } (Уже записан)

   - GET /courses/:id/check-registration
     - Описание: Проверка, записан ли пользователь на курс.
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { isRegistered: boolean, enrollment: Enrollment | null } (Статус записи)

   - POST /courses/:id/lessons/:lessonId/access
     - Описание: Обновление информации о последнем просмотренном уроке (для "Continue Watching").
     - Параметры (Params): id (ID курса), lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { message: "Last lesson updated successfully" }
       - 404 Not Found (Если не записан или урок не найден)

   - POST /courses/:id/lessons/:lessonId/complete
     - Описание: Отметка урока как пройденного и обновление общего прогресса курса.
     - Параметры (Params): id (ID курса), lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 201 Created: { message: "Lesson completed", progress: number } (Новый прогресс в %)

   - GET /courses/:id/progress
     - Описание: Получение детального прогресса по курсу (какие уроки пройдены).
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { progress: number, completedLessonIds: string[] } (Прогресс и ID пройденных уроков)

3. Users Module (Модуль Пользователей)
   - GET /users/me
     - Описание: Получение полной информации о текущем пользователе.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: User (Данные пользователя)

4. Lessons Module (Модуль Уроков)
   - GET /lessons/:id
     - Описание: Получение детальной информации об уроке.
     - Параметры (Params): id (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Lesson (Урок с тестами, информацией о модуле и курсе, и статусом завершения)
         - Поля: id, title, content, material_url, material_type, position, created_at, updated_at
         - tests: Test[] (Тесты урока)
         - modules: { id, title, course_id, courses: { id, title } } (Информация о модуле и курсе)
         - completed: boolean (Завершен ли урок текущим пользователем)
       - 404 Not Found: { message: "Lesson not found" }

   - GET /lessons/:id/material
     - Описание: Получение ссылки на материалы урока (видео/PDF).
     - Параметры (Params): id (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { lessonId, title, materialUrl, expiresIn } (Временная ссылка на файл)
       - 404 Not Found (Урок или материал не найден)

5. Modules Module (Модуль Модулей)
   - GET /modules/:id
     - Описание: Получение детальной информации о модуле с уроками и прогрессом.
     - Параметры (Params): id (ID модуля)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Module (Модуль с уроками, тестами и статусом завершения)
         - Поля: id, title, description, position, course_id, created_at, updated_at
         - tests: Test[] (Тесты модуля)
         - lessons: Lesson[] (Уроки с полем completed: boolean для каждого)
         - courses: { id, title } (Информация о курсе)
         - progress: number (Процент завершения модуля 0-100)
         - completed: boolean (Все ли уроки модуля завершены)
       - 404 Not Found: { message: "Module not found" }

6. Tests Module (Модуль Тестов)
   - GET /user/tests/lesson/:lessonId
     - Описание: Получение теста, привязанного к конкретному уроку.
     - Параметры (Params): lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test | null
         - Если тест найден, возвращается объект теста с дополнительными полями:
           - completed: boolean (пройден ли тест пользователем)
           - passed: boolean (сдан ли тест успешно)
           - score: number (набранные баллы, 0-100)
         - questions: Question[] (Вопросы с ответами)

   - GET /user/tests/module/:moduleId
     - Описание: Получение теста, привязанного к модулю.
     - Параметры (Params): moduleId (ID модуля)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test | null
         - Если тест найден, возвращается объект теста с дополнительными полями:
           - completed: boolean (пройден ли тест пользователем)
           - passed: boolean (сдан ли тест успешно)
           - score: number (набранные баллы, 0-100)
         - questions: Question[] (Вопросы с ответами)

   - GET /user/tests/course/:courseId
     - Описание: Получение теста, привязанного к курсу (финальный тест).
     - Параметры (Params): courseId (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test | null
         - Если тест найден, возвращается объект теста с дополнительными полями:
           - completed: boolean (пройден ли тест пользователем)
           - passed: boolean (сдан ли тест успешно)
           - score: number (набранные баллы, 0-100)
         - questions: Question[] (Вопросы с ответами)

   - GET /user/tests/:testId/result
     - Описание: Получение результата пройденного теста для текущего пользователя.
     - Параметры (Params): testId (ID теста)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: TestResult | null
         - Если тест был пройден, возвращается объект результата:
           - id: string (ID результата)
           - score: number (Набранные баллы, 0-100)
           - passed: boolean (Сдан ли тест успешно)
           - completed_at: Date (Дата и время прохождения)
           - test: { id, title, passing_score, questions_to_show } (Информация о тесте)
         - Если тест не был пройден, возвращается null

   - GET /user/tests/module/:moduleId/result
     - Описание: Получение результата теста модуля для текущего пользователя.
     - Параметры (Params): moduleId (ID модуля)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает: 200 OK: TestResult | null

   - GET /user/tests/course/:courseId/result
     - Описание: Получение результата финального теста курса для текущего пользователя.
     - Параметры (Params): courseId (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает: 200 OK: TestResult | null

   - POST /user/tests/:testId/submit
     - Описание: Отправка ответов на тест и получение результата.
     - Параметры (Params): testId (ID теста)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Тело запроса (Body):
       - answers: Array<{ questionId: string, answerId: string }> (Массив ответов)
     - Возвращает:
       - 201 Created:
         - id: string (ID результата)
         - score: number (Баллы в процентах 0-100)
         - passed: boolean (Сдан ли тест)
         - completed_at: Date (Дата прохождения)
       - 404 Not Found (Тест не найден)

7. Practices Module (Модуль Практики - Задачи с кодом)
   - GET /practices/lesson/:lessonId
     - Описание: Получение всех задач для урока.
     - Роли: все (публичный/авторизованный)
     - Возвращает: 200 OK: Array<{
         id: string,
         lesson_id: string,
         title: string,
         description: string | null,
         language: string (default: "javascript"),
         initial_code: string | null,
         expected_output: string | null,
         test_cases: JSONArray | null,
         solution_code: string | null,
         created_at: Date
       }>

   - GET /practices/:id
     - Описание: Получение одной задачи по ID.
     - Возвращает: 200 OK: Practice (объект с полями выше)

