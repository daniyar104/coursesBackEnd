API Endpoints (Документация API)

1. Auth Module (Модуль Авторизации)
   - POST /auth/register
     - Описание: Регистрация нового пользователя.
     - Тело запроса (Body): RegisterDto
       - firstName: string (Имя)
       - surname: string (Фамилия)
       - email: string (Email, уникальный)
       - password: string (Пароль, мин. 6 символов)
     - Возвращает:
       - 201 Created: { user: User } (Созданный пользователь)
       - 401 Unauthorized: { message: "Email already registered" } (Email уже занят)

   - POST /auth/login
     - Описание: Вход в систему (логин).
     - Тело запроса (Body):
       - email: string
       - password: string
     - Возвращает:
       - 201 Created: { user: User, token: string } (Пользователь и JWT токен)
       - 401 Unauthorized: { message: "Invalid credentials" } (Неверные данные)

   - GET /auth/profile
     - Описание: Получение профиля текущего пользователя по токену.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: User (Данные пользователя из токена)
       - 401 Unauthorized: { message: "Invalid token" } (Неверный токен)

2. Courses Module (Модуль Курсов)
   - GET /courses
     - Описание: Получение списка всех курсов.
     - Возвращает:
       - 200 OK: { data: Course[] } (Список курсов с категориями и количеством модулей)

   - GET /courses/categories
     - Описание: Получение списка всех категорий курсов.
     - Возвращает:
       - 200 OK: { data: Category[] } (Список категорий)
       - Поля категории: id, name, description, created_at

   - GET /courses/enrolled/with-last-lesson
     - Описание: Получение списка курсов, на которые записан пользователь, с информацией о последнем открытом уроке.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { data: Course[] }
       - Включает: enrollment (прогресс), lastLesson (последний урок: id, title, module)

   - GET /courses/enrolled
     - Описание: Получение списка курсов, на которые записан пользователь (без детальной инфо о последнем уроке).
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { data: Course[] } (Список курсов с прогрессом)

   - GET /courses/:id
     - Описание: Получение детальной информации о конкретном курсе.
     - Параметры (Params): id (ID курса)
     - Возвращает:
       - 200 OK: { data: Course } (Курс с модулями, уроками, категориями и отзывами)
       - 404 Not Found: { message: "Course not found" } (Курс не найден)

   - POST /courses/:id/register
     - Описание: Запись пользователя на курс.
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 201 Created: { message: "Successfully registered", enrollment: Enrollment } (Успешная запись)
       - 201 Created: { message: "User already enrolled", enrollment: Enrollment } (Уже записан)

   - GET /courses/:id/check-registration
     - Описание: Проверка, записан ли пользователь на курс.
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { isRegistered: boolean, enrollment: Enrollment | null } (Статус записи)

   - POST /courses/:id/lessons/:lessonId/access
     - Описание: Обновление информации о последнем просмотренном уроке (для "Continue Watching").
     - Параметры (Params): id (ID курса), lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { message: "Last lesson updated successfully" }
       - 404 Not Found (Если не записан или урок не найден)

   - POST /courses/:id/lessons/:lessonId/complete
     - Описание: Отметка урока как пройденного и обновление общего прогресса курса.
     - Параметры (Params): id (ID курса), lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 201 Created: { message: "Lesson completed", progress: number } (Новый прогресс в %)

   - GET /courses/:id/progress
     - Описание: Получение детального прогресса по курсу (какие уроки пройдены).
     - Параметры (Params): id (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { progress: number, completedLessonIds: string[] } (Прогресс и ID пройденных уроков)

3. Users Module (Модуль Пользователей)
   - GET /users/me
     - Описание: Получение полной информации о текущем пользователе.
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: User (Данные пользователя)

4. Lessons Module (Модуль Уроков)
   - GET /lessons/:id/material
     - Описание: Получение ссылки на материалы урока (видео/PDF).
     - Параметры (Params): id (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: { lessonId, title, materialUrl, expiresIn } (Временная ссылка на файл)
       - 404 Not Found (Урок или материал не найден)

5. Tests Module (Модуль Тестов)
   - GET /user/tests/lesson/:lessonId
     - Описание: Получение теста, привязанного к конкретному уроку.
     - Параметры (Params): lessonId (ID урока)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test (Тест с вопросами и ответами) | null

   - GET /user/tests/module/:moduleId
     - Описание: Получение теста, привязанного к модулю.
     - Параметры (Params): moduleId (ID модуля)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test | null

   - GET /user/tests/course/:courseId
     - Описание: Получение теста, привязанного к курсу (финальный тест).
     - Параметры (Params): courseId (ID курса)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Возвращает:
       - 200 OK: Test | null

   - POST /user/tests/:testId/submit
     - Описание: Отправка ответов на тест и получение результата.
     - Параметры (Params): testId (ID теста)
     - Заголовки (Headers): Authorization: Bearer <token>
     - Тело запроса (Body):
       - answers: Array<{ questionId: string, answerId: string }> (Массив ответов)
     - Возвращает:
       - 201 Created:
         - id: string (ID результата)
         - score: number (Баллы в процентах 0-100)
         - passed: boolean (Сдан ли тест)
         - completed_at: Date (Дата прохождения)
       - 404 Not Found (Тест не найден)
